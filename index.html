<!DOCTYPE html>
<html>
<head>
  <title>News Minimalist Reader</title>
  <meta charset="utf-8" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-title" content="News Minimalist Reader" />
  <meta name="theme-color" content="#000A16" media="(prefers-color-scheme: dark)" />
  <meta name="theme-color" content="#FFFFFF" media="(prefers-color-scheme: light)" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="icon" href="favicon.png" />
  <link rel="stylesheet" href="index.css" />
  <link rel="apple-touch-icon" href="appicon.png" />
</head>
<body>
  <script>
    const pick = (keys) => (item) => keys.reduce((acc, cur) => ({
      ...acc,
      [cur.replace(':encoded', '')]: item.getElementsByTagName(cur)[0].textContent,
    }), {})

    fetch('https://nameless-bread-889b.jbonigomes.workers.dev/')
      .then((response) => response.text())
      .then((text) => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(text, 'application/xml')
        const items = ['guid', 'title', 'content:encoded'];
        const data = [...doc.getElementsByTagName('item')].map(pick(items))
        const html = data.map(({ guid, link, title, content }) => `
          <details name="feed" id="${guid}">
            <summary>${title}</summary>
            <p>${content}</p>
          </details>
        `).join('')

        document.body.innerHTML = html
      })
  </script>
</body>
</html>
